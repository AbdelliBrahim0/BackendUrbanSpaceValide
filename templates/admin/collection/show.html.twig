{% extends 'base.html.twig' %}

{% block title %}Détails de la collection - {{ collection.name }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        body { background-color: #121212; color: #fff; }
        .card { 
            background-color: #1e1e1e; 
            border: none; 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .card-header {
            background: linear-gradient(90deg, #30aee6, #22c7b0);
            color: white;
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
            border: none;
        }
        .btn-primary {
            background: linear-gradient(90deg, #30aee6, #22c7b0);
            border: none;
            font-weight: 600;
            transition: all 0.3s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(34,199,176,0.6);
        }
        .btn-light {
            background-color: #3d3d3d;
            color: #fff;
            border: 1px solid #4d4d4d;
        }
        .btn-light:hover {
            background-color: #4d4d4d;
            color: #fff;
        }
        .text-muted {
            color: #8e8e8e !important;
        }
        .url-link {
            color: #22c7b0;
            text-decoration: none;
        }
        .url-link:hover {
            text-decoration: underline;
        }
        .product-badge {
            background-color: #22c7b0;
            color: white;
            border-radius: 10px;
            padding: 3px 8px;
            font-size: 0.8rem;
            margin: 2px;
            display: inline-block;
        }
        .description-box {
            background-color: #2d2d2d;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="text-gradient">Détails de la collection</h1>
        <div>
            <a href="{{ path('admin_collections_edit', {'id': collection.id}) }}" class="btn btn-primary me-2">
                <i class="fas fa-edit me-1"></i> Modifier
            </a>
            <a href="{{ path('admin_collections_index') }}" class="btn btn-light">
                <i class="fas fa-arrow-left me-1"></i> Retour à la liste
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h2 class="mb-0">{{ collection.name }}</h2>
            <small class="text-white-50">Créée le {{ collection.createdAt|date('d/m/Y à H:i') }}</small>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h5 class="text-info">Description principale</h5>
                            <div class="description-box">
                                {{ collection.description1 ?? '<span class="text-muted">Aucune description principale</span>'|raw }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5 class="text-info">Description secondaire</h5>
                            <div class="description-box">
                                {{ collection.description2 ?? '<span class="text-muted">Aucune description secondaire</span>'|raw }}
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-info">Liens associés</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="description-box h-100">
                                    <h6>Lien 1</h6>
                                    {% if collection.url1 %}
                                        <a href="{{ collection.url1 }}" target="_blank" class="url-link">{{ collection.url1 }}</a>
                                    {% else %}
                                        <span class="text-muted">Non défini</span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="description-box h-100">
                                    <h6>Lien 2</h6>
                                    {% if collection.url2 %}
                                        <a href="{{ collection.url2 }}" target="_blank" class="url-link">{{ collection.url2 }}</a>
                                    {% else %}
                                        <span class="text-muted">Non défini</span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="description-box h-100">
                                    <h6>Lien 3</h6>
                                    {% if collection.url3 %}
                                        <a href="{{ collection.url3 }}" target="_blank" class="url-link">{{ collection.url3 }}</a>
                                    {% else %}
                                        <span class="text-muted">Non défini</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h5 class="text-info">Produits associés ({{ collection.products|length }})</h5>
                        <div class="description-box">
                            {% if collection.products|length > 0 %}
                                {% for product in collection.products %}
                                    <span class="product-badge">{{ product.name }}</span>
                                {% endfor %}
                            {% else %}
                                <span class="text-muted">Aucun produit associé à cette collection</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="d-flex justify-content-between mt-5">
                        <div>
                            <a href="{{ path('admin_collections_edit', {'id': collection.id}) }}" class="btn btn-primary">
                                <i class="fas fa-edit me-1"></i> Modifier
                            </a>
                            <button type="button" class="btn btn-danger ms-2" data-bs-toggle="modal" data-bs-target="#deleteModal">
                                <i class="fas fa-trash me-1"></i> Supprimer
                            </button>
                        </div>
                        <a href="{{ path('admin_collections_index') }}" class="btn btn-light">
                            <i class="fas fa-arrow-left me-1"></i> Retour à la liste
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content bg-dark text-light">
            <div class="modal-header border-0">
                <h5 class="modal-title" id="deleteModalLabel">Confirmer la suppression</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Êtes-vous sûr de vouloir supprimer la collection "{{ collection.name }}" ?</p>
                <p class="text-warning">Cette action est irréversible.</p>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                <form action="{{ path('admin_collections_delete', {'id': collection.id}) }}" method="post" class="d-inline">
                    <input type="hidden" name="_method" value="DELETE">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ collection.id) }}">
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash me-1"></i> Supprimer définitivement
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        // Initialize tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    </script>
{% endblock %}
